id: disable-ssh-password
name: Disable SSH Password Auth
description: Disable password authentication for SSH (key-only access)
category: security
os: [debian, redhat]
priority: 6
repeatable: false

params: []

scripts:
  debian: |
    sed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config
    sed -i 's/^#*ChallengeResponseAuthentication.*/ChallengeResponseAuthentication no/' /etc/ssh/sshd_config
    systemctl restart sshd
    log_success "SSH password authentication disabled"

  redhat: |
    sed -i 's/^#*PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config
    sed -i 's/^#*ChallengeResponseAuthentication.*/ChallengeResponseAuthentication no/' /etc/ssh/sshd_config
    systemctl restart sshd
    log_success "SSH password authentication disabled"
